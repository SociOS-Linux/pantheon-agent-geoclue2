#!/usr/bin/python

APP_ID = "io.elementary.desktop.agent-geoclue2"

import sys
from ConfigParser import SafeConfigParser

parser = SafeConfigParser ()
parser.readfp (sys.stdin)

allowed_agents = parser.get ("agent", "whitelist")
if APP_ID not in allowed_agents:
    allowed_agents += ";" + APP_ID;
    parser.set ("agent", "whitelist", allowed_agents)

if not parser.has_section (APP_ID):
    parser.add_section (APP_ID)
    parser.set (APP_ID, "allowed", "true")
    parser.set (APP_ID, "system", "true")
    parser.set (APP_ID, "users", "")
    
parser.write (sys.stdout)
